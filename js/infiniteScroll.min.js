// Laadt nieuwe spots in overzicht wanneer de onderkant wordt bereikt
function attachInfiniteScroll() {
	//ready
// console.time("2nd-ready");
	var pagenr = $('#nextPage').val();
	$(window).scroll(function() {
		var url = '?direction=next&data[spotsonly]=1&pagenr='+pagenr+$('#getURL').val()+' #spots';
		if($(document).scrollTop() >= $(document).height() - $(window).height() && $(document).height() >= $(window).height() && pagenr > 0 && $("#overlay").is(':hidden')) {
			if(!($("div.spots").hasClass("full"))) {
				var scrollLocation = $("div.container").scrollTop();
				$(".navi").hide();
				$("#overlay").show();
				$("#loader").show();
				$("div#overlay").load(url, function() {				
					if($("div#overlay tbody#spots").children().size() < $('#perPage').val()) {
						$("table.footer").remove();
						$("div.spots").addClass("full");
					}
					$("#loader").hide();
					$("#overlay").hide(); 
					$("tbody#spots").append($($("div#overlay tbody#spots").html()).show());
					$("div#overlay").empty();
					$("a.spotlink").click(function(e) { e.preventDefault(); });
					
					pagenr++;
					$("td.next > a").attr("href", url);
					$("div.container").scrollTop(scrollLocation);
				});
			}
		}
	});
// console.timeEnd("2nd-ready");
} // attachInfiniteScroll